# 京东宠物玩具商品数据爬虫

这是一个使用 Python 编写的Web爬虫脚本，用于从京东（JD.com）抓取宠物玩具的商品信息和用户评论，并将结果保存到 Excel 文件中。

## 功能

- 自动打开浏览器并访问京东宠物玩具的搜索结果页面。
- 模拟用户点击，按“销量”对商品进行排序。
- 抓取搜索结果列表页前4个商品的以下信息：
  - 商品名称
  - 价格
  - 促销活动
  - 店铺名称
  - 销量数据
- 依次进入每个商品的详情页，并跳转到“全部评价”页面。
- 采集每个商品最多20条有效评论，并进行数据清洗，过滤掉无效内容（如“此用户未填写评价内容”）。
- 具备错误恢复机制：在遇到页面断开连接或其它异常时，会自动重启浏览器并继续处理下一个商品。
- 将所有抓取到的数据整合并输出到一个 Excel 文件 (`jd_result.xlsx`) 中：
  - 第一个工作表 `商品总览` 包含所有商品的基本信息。
  - 每个商品对应一个单独的工作表，以商品名称命名，包含其采集到的评论。

## 依赖库

运行此脚本需要安装以下 Python 库：

- `requests`
- `DrissionPage`
- `beautifulsoup4`
- `pandas`
- `openpyxl`

你可以使用 pip 来安装它们：
```bash
pip install requests DrissionPage beautifulsoup4 pandas openpyxl
```

## 如何使用

1.  **安装依赖**:
    确保你已经安装了所有必需的库。

2.  **配置浏览器**:
    `DrissionPage` 需要一个基于 Chromium 的浏览器（如 Google Chrome 或 Microsoft Edge）才能运行。请确保你的电脑上已安装，并且 `DrissionPage` 可以自动管理或找到对应的浏览器驱动。

3.  **运行脚本**:
    直接在终端中执行 Python 脚本：
    ```bash
    python text.py
    ```

4.  **查看结果**:
    脚本执行完毕后，会在 `D:\cursorproject\` 目录下生成一个名为 `jd_result.xlsx` 的 Excel 文件。你可以打开它来查看抓取到的数据。

## 注意事项

- **抓取数量限制**: 当前脚本被设置为只抓取搜索结果中的前4个商品。你可以通过修改 `text.py` 文件中的 `[:4]` 切片来调整抓取的商品数量。
- **文件路径**: 输出的 Excel 文件路径被硬编码为 `D:\cursorproject\jd_result.xlsx`。如果需要，请在脚本中修改 `output_path` 变量的值。
- **网络与反爬**: 网站的结构可能会发生变化，或者京东可能会更新其反爬虫策略，这都可能导致脚本失效。如果脚本运行失败，请检查网站结构是否已更改。